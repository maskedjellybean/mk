(function(){config.pieces_per_row=3,config.pieces_count=null,config.row_count=null,config.pieces_per_row_zero=config.pieces_per_row-1,config.pieces_count_zero=null,config.row_count_zero=null,angular.module("portfolio").factory("rowsFactory",function($http,$q){delete $http.defaults.headers.common["X-Requested-With"];var target="http://www.benteegarden.com/api/megan.jsonp?callback=JSON_CALLBACK",pieceToggles=[],secondaryImages={},rows={},service={};return service.createRows=function(){var deferred=$q.defer();return $http({method:"JSONP",url:target}).success(function(data){pieces=data.portfolio,piecesCount=pieces.length,config.pieces_count=piecesCount,config.pieces_count_zero=piecesCount-1;for(var p=0;piecesCount>p;p++){pieceToggles[p]={transform:!1,backActive:!1,noFlipHelp:!1,notFlippable:!1,frontSwapped:!1,backSwapped:!1,showMoreActive:!1,fade:!1,hidePrimaryImg:!1,hideDescription:!1,hideBackNbrImg_0:!0,hideBackNbrImg_1:!0,hideBackNbrImg_2:!0,hideFrontNbrImg_0:!0,hideFrontNbrImg_1:!0,hideFrontNbrImg_2:!0},secondaryImages["piece_"+[p]]=[];var images=pieces[p].images;images=images.split(","),pieces[p].images=images;for(var i=0;images.length>i;i++)0===i?pieces[p].primary_image=images[i]:secondaryImages["piece_"+[p]].push(images[i]);delete pieces[p].images}for(p=0;piecesCount>p;p++)if(3===config.pieces_per_row){var mod=p%3;pieces[p].neighbor_images=[];var neighbor1,neighbor2;0===mod?(pieces[p].row_position="left",neighbor1=p+1,neighbor1="piece_"+(""+neighbor1),secondaryImages[neighbor1]!==void 0&&(neighbor1=secondaryImages[neighbor1][0],pieces[p].neighbor_images.center=neighbor1),neighbor2=p+2,neighbor2="piece_"+(""+neighbor2),secondaryImages[neighbor2]!==void 0&&(neighbor2=secondaryImages[neighbor2][0],pieces[p].neighbor_images.right=neighbor2)):1===mod?(pieces[p].row_position="center",neighbor1=p-1,neighbor1="piece_"+(""+neighbor1),secondaryImages[neighbor1]!==void 0&&(neighbor1=secondaryImages[neighbor1][0],pieces[p].neighbor_images.left=neighbor1),neighbor2=p+1,neighbor2="piece_"+(""+neighbor2),secondaryImages[neighbor2]!==void 0&&(neighbor2=secondaryImages[neighbor2][1],pieces[p].neighbor_images.right=neighbor2)):2===mod&&(pieces[p].row_position="right",neighbor1=p-1,neighbor1="piece_"+(""+neighbor1),secondaryImages[neighbor1]!==void 0&&(neighbor1=secondaryImages[neighbor1][1],pieces[p].neighbor_images.center=neighbor1),neighbor2=p-2,neighbor2="piece_"+(""+neighbor2),secondaryImages[neighbor2]!==void 0&&(neighbor2=secondaryImages[neighbor2][1],pieces[p].neighbor_images.left=neighbor2))}var rowCount=0;for(p=0;piecesCount>=p;p++)if(3===config.pieces_per_row){var rowTemp=pieces.splice(0,3);rowTemp.length===config.pieces_per_row&&(rows["row_"+rowCount]=rowTemp,rows["row_"+rowCount].toggles={},rows["row_"+rowCount].toggles=pieceToggles.splice(0,3),rowCount++,piecesCount-=3)}config.row_count=rowCount,config.row_count_zero=rowCount-1,deferred.resolve(rows)}).error(function(){deferred.reject()}),deferred.promise},service})})();